---
layout:     post
title:     	docker私服搭建与使用
subtitle:    "\"docker 私服 \""
date:       2017-10-16
author:     Mr Chang
header-img: img/post-bg-mma-1.jpg
catalog: true
tags:
    - Registry
    - docker
    - nexus
    - 私服

---

# docker Registry

1. 这是什么
	
	是一种无状态，高度可扩展的服务器端应用程序，可存储和分发Docker映像。该注册表是开源的，在许可的Apache许可证下
	
2. 为什么用它
	* 严格控制您的图像存储位置
	* 完全拥有您的图像分配管道
	* 将图像存储和分发紧密集成到您的内部开发工作流程中

	
## 安装

### 第一种方式 

	docker run -d -p 5000:5000 --name registry registry:2
	
查看私有镜像

	http://ip:5000/v2/_catalog
	
### 第二种方式

nexus 3.X支持docker私有仓库

	docker run -d -p 8081:8081 --name nexus sonatype/nexus3
	
登陆 admin admin123

选择 Repositories->Create repository->docker (hosted)

![](http://files.jetbrains.org.cn/17-10-17/42348025.jpg)


## 测试

创建好以后更改 docker 参数，测试即可

	# 增加非安全仓库
	vim /usr/lib/systemd/system/docker.service
	# 在 ExecStart 
	--insecure-registry localhost:8081
	# 重启 docker
	systemctl daemon-reload
	systemctl restart docker
	
测试 push 和 pull 镜像

	* 将镜像设置一个私服标签版本
		docker tag 镜像名 localhost:8081/镜像名
	* 提交到docker私服
		docker push localhost:8081/镜像名
	* 下载私服镜像到本地
		docker pull localhost:8081/镜像名
		
		
##鸣谢

**nexus：https://help.sonatype.com/display/NXRM3**
**docker registry : https://docs.docker.com/registry/**
**docker hub :https://hub.docker.com/_/registry/**
	
